<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:VideoSlicer.ViewModels"
        xmlns:vlc="using:LibVLCSharp.Avalonia"
        x:Class="VideoSlicer.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="Avalonia Video Player"
        Width="1000"
        Height="700"
        MinWidth="600"
        MinHeight="400">

  <Window.KeyBindings>
    <KeyBinding Gesture="Ctrl+O" Command="{Binding OpenFileCommand}" />
    <KeyBinding Gesture="Space" Command="{Binding PlayPauseCommand}" />
    <KeyBinding Gesture="F11" Command="{Binding ToggleFullScreenCommand}" />
    <KeyBinding Gesture="Escape" Command="{Binding ExitFullScreenCommand}" />
  </Window.KeyBindings>

  <Design.DataContext>
    <vm:MainWindowViewModel/>
  </Design.DataContext>

  <Grid RowDefinitions="Auto,*,Auto">
    <!-- Menu Bar -->
    <Menu Grid.Row="0">
      <MenuItem Header="_File">
        <MenuItem Header="_Open Video..." 
                  Command="{Binding OpenFileCommand}"
                  InputGesture="Ctrl+O">
          <MenuItem.Icon>
            <PathIcon Data="M4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H16L12,22L8,18H4A2,2 0 0,1 2,16V4A2,2 0 0,1 4,2M4,4V16H8.83L12,19.17L15.17,16H20V4H4Z" />
          </MenuItem.Icon>
        </MenuItem>
        <Separator />
        <MenuItem Header="E_xit" Command="{Binding ExitCommand}" />
      </MenuItem>
      <MenuItem Header="_View">
        <MenuItem Header="_Full Screen" 
                  Command="{Binding ToggleFullScreenCommand}"
                  InputGesture="F11" />
      </MenuItem>
    </Menu>

    <!-- Video Display Area -->
    <Border Grid.Row="1" 
            Background="Black"
            ClipToBounds="True">
      <Grid>
        <vlc:VideoView MediaPlayer="{Binding MediaPlayer}" 
                       IsVisible="{Binding IsVideoLoaded}" />
        
        <!-- No Video Message -->
        <StackPanel IsVisible="{Binding !IsVideoLoaded}"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="10">
          <PathIcon Data="M18,3V5H16V3H18M13.5,9A1.5,1.5 0 0,1 15,7.5A1.5,1.5 0 0,1 16.5,9A1.5,1.5 0 0,1 15,10.5A1.5,1.5 0 0,1 13.5,9M14,2A2,2 0 0,1 16,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4H8A2,2 0 0,1 10,2H14M4,6V18H20V6H4Z"
                    Width="64"
                    Height="64"
                    Foreground="Gray" />
          <TextBlock Text="No video loaded"
                     FontSize="16"
                     Foreground="Gray"
                     HorizontalAlignment="Center" />
          <Button Content="Open Video File"
                  Command="{Binding OpenFileCommand}"
                  HorizontalAlignment="Center"
                  Classes="accent" />
        </StackPanel>
      </Grid>
    </Border>

    <!-- Control Panel -->
    <Border Grid.Row="2" 
            Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
            Padding="10">
      <Grid ColumnDefinitions="Auto,10,*,10,Auto,10,Auto">
        
        <!-- Play/Pause Button -->
        <Button Grid.Column="0"
                Command="{Binding PlayPauseCommand}"
                IsEnabled="{Binding IsVideoLoaded}"
                Width="40"
                Height="40"
                Classes="control-button">
          <PathIcon Data="{Binding PlayButtonIcon}" 
                    Width="16" 
                    Height="16" />
        </Button>

        <!-- Progress Bar and Time -->
        <StackPanel Grid.Column="2" 
                    VerticalAlignment="Center"
                    Spacing="5">
          <Slider Value="{Binding Position}"
                  Maximum="1"
                  IsEnabled="{Binding IsVideoLoaded}"
                  Classes="video-progress" />
          <StackPanel Orientation="Horizontal"
                      HorizontalAlignment="Center"
                      Spacing="5">
            <TextBlock Text="{Binding CurrentTime}"
                       FontSize="12"
                       Foreground="Gray" />
            <TextBlock Text="/"
                       FontSize="12"
                       Foreground="Gray" />
            <TextBlock Text="{Binding TotalTime}"
                       FontSize="12"
                       Foreground="Gray" />
          </StackPanel>
        </StackPanel>

        <!-- Volume Control -->
        <StackPanel Grid.Column="4"
                    Orientation="Horizontal"
                    VerticalAlignment="Center"
                    Spacing="5">
          <Button Command="{Binding ToggleMuteCommand}"
                  Width="30"
                  Height="30"
                  Classes="control-button">
            <PathIcon Data="{Binding VolumeIcon}" 
                      Width="14" 
                      Height="14" />
          </Button>
          <Slider Value="{Binding Volume}"
                  Maximum="100"
                  Width="80"
                  VerticalAlignment="Center" />
        </StackPanel>

        <!-- Full Screen Button -->
        <Button Grid.Column="6"
                Command="{Binding ToggleFullScreenCommand}"
                Width="30"
                Height="30"
                Classes="control-button">
          <PathIcon Data="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z" 
                    Width="14" 
                    Height="14" />
        </Button>
      </Grid>
    </Border>
  </Grid>
</Window>